---
import { getCollection } from 'astro:content';
import { Responsive } from '../../../components/common';
import Section from '../../../components/common/Section.astro';
import Layout from '../../../layouts/MainGridLayout.astro';
import ProjectCard from '../../../components/common/ProjectCard.astro';

export async function getStaticPaths({ paginate }) {
  const projects = await getCollection('project');
  const sortedProjects = projects.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
  
  return paginate(sortedProjects, { pageSize: 6 });
}

const { page } = Astro.props;
const pageTitle = `프로젝트 (${page.currentPage}/${page.lastPage}) - 포트폴리오`;
---

<Layout title={pageTitle} hasHeaderBackground={true}>
  <Section>
    <Responsive>
      <div class="py-12">
        <h1 class="text-4xl font-bold text-center text-gray-900 dark:text-white mb-12">프로젝트</h1>
        
        <!-- 프로젝트 리스트 -->
        <div class="space-y-8 mb-12">
          {page.data.map((project, index) => (
            <ProjectCard project={project} variant="detailed" index={index} />
          ))}
        </div>
        
        <!-- 페이지네이션 -->
        {page.lastPage > 1 && (
          <nav class="flex justify-center items-center gap-2" aria-label="페이지네이션">
            {page.url.prev && (
              <a 
                href={page.url.prev}
                class="px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors"
              >
                ← 이전
              </a>
            )}
            
            {Array.from({ length: page.lastPage }, (_, i) => i + 1).map((pageNum) => (
              <a 
                href={`/project/page/${pageNum}`}
                class={`px-3 py-2 rounded-md transition-colors ${
                  pageNum === page.currentPage 
                    ? 'bg-blue-600 dark:bg-blue-500 text-white' 
                    : 'text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20'
                }`}
              >
                {pageNum}
              </a>
            ))}
            
            {page.url.next && (
              <a 
                href={page.url.next}
                class="px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors"
              >
                다음 →
              </a>
            )}
          </nav>
        )}
      </div>
    </Responsive>
  </Section>
</Layout> 